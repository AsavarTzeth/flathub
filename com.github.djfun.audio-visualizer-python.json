{
  "app-id": "com.github.djfun.audio-visualizer-python",
  "runtime": "org.freedesktop.Platform",
  "runtime-version": "1.6",
  "sdk": "org.freedesktop.Sdk",
  "command": "avp.wrapper",
  "finish-args": [
    /* X11 + XShm access */
    "--share=ipc", "--socket=x11",
    "--socket=wayland",
    "--socket=pulseaudio",
    "--filesystem=home:rw",
    "--persist=.config/audio-visualizer"
  ],
  "cleanup": [
    "/include",
    "/lib/pkgconfig"
  ],
  "modules": [
    {
      "name": "audio-visualizer-python",
      "buildsystem": "simple",
      "build-commands": [
        "python3 setup.py install --prefix=/app --root=/ --optimize=1"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/djfun/audio-visualizer-python.git",
          "branch": "feature-newgui",
          "commit": "4becfe3b51ae058dc8600abeac3d1d6b5a1eab76"
        },
        {
          "type": "file",
          "path": "com.github.djfun.audio-visualizer-python.appdata.xml"
        },
        {
          "type": "file",
          "path": "avp.wrapper"
        }
      ],
      "post-install": [
        "install -Dm644 com.github.djfun.audio-visualizer-python.appdata.xml /app/share/appdata/com.github.djfun.audio-visualizer-python.appdata.xml",
        "install -Dm755 avp.wrapper /app/bin/avp.wrapper"
      ],
      "modules": [
        "qt5-qtbase-5.9.1.json",
        {
          "name": "pyqt5",
          "buildsystem": "simple",
          "build-commands": [
            "pip3 install --prefix=/app PyQt5-5.9-5.9.1-cp35.cp36.cp37-abi3-manylinux1_x86_64.whl"
          ],
          "sources": [{
            "type": "file",
            "url": "https://pypi.python.org/packages/45/63/353403622330d335631ec3a3016f9e0a6a9519082488b1421003682f8ef4/PyQt5-5.9-5.9.1-cp35.cp36.cp37-abi3-manylinux1_x86_64.whl",
            "sha256": "18cff7c0d0eb9f7c5783929f21fd7a49904e49827aeec88359cf60cccbd94a86"
          }],
          "modules": [{
            "name": "sip",
            "buildsystem": "simple",
            "build-commands": [
              "pip3 install --prefix=/app sip-4.19.3-cp35-cp35m-manylinux1_x86_64.whl"
            ],
            "sources": [{
              "type": "file",
              "url": "https://pypi.python.org/packages/e5/d3/909f9971037c79bbd0c8a59bf8ba2b5359bf1384a1a8973daff838388af6/sip-4.19.3-cp35-cp35m-manylinux1_x86_64.whl",
              "sha256": "41077431be4c4b1bde0db19ca022ffbf4a4ef62593482694be3565eadae33c92"
            }]
          }]
        },
        {
          "name": "ffmpeg",
          "cleanup": ["/share"],
          "config-opts": [
            "--enable-shared",
            "--disable-static",
            "--disable-doc",
            "--disable-ffplay",
            "--disable-ffprobe",
            "--disable-ffserver",
            "--disable-devices",
            "--enable-gnutls",
            "--enable-gpl",
            "--enable-libfreetype",
            "--enable-libmp3lame",
            "--enable-libvorbis",
            "--enable-libvpx",
            "--enable-libx264",
            "--enable-libxcb",
            "--enable-libxvid",
            "--disable-cuda",
            "--disable-cuvid"
          ],
          "sources": [{
            "type": "archive",
            "url": "https://ffmpeg.org/releases/ffmpeg-3.3.2.tar.xz",
            "sha256": "1998de1ab32616cbf2ff86efc3f1f26e76805ec5dc51e24c041c79edd8262785"
          }],
          "modules": [
            {
              "name": "lame",
              "config-opts": [
                "--disable-static",
                "--disable-frontend",
                /* Disable docs */
                "--datarootdir=/"
              ],
              "sources": [{
                "type": "archive",
                "url": "https://downloads.sourceforge.net/lame/lame-3.99.5.tar.gz",
                "sha256": "24346b4158e4af3bd9f2e194bb23eb473c75fb7377011523353196b19b9a23ff"
              }]
            },
            {
              "name": "libx264",
              "config-opts": [
                "--enable-shared",
                "--disable-cli"
              ],
              "sources": [{
                "type": "git",
                "url": "https://git.videolan.org/git/x264.git",
                "branch": "stable",
                "commit": "aaa9aa83a111ed6f1db253d5afa91c5fc844583f"
              }]
            },
            {
              "name": "xvid",
              "cleanup": ["/lib/libxvidcore.a"],
              "subdir": "build/generic",
              "sources": [{
                "type": "archive",
                "url": "http://downloads.xvid.org/downloads/xvidcore-1.3.4.tar.bz2",
                "sha256": "5faf6380b828db8ad29f0b69f030edf86d0fe26d1f9c5427030c6accd3ad8bf7"
              }]
            }
          ]
        },
        {
          "name": "numpy",
          "buildsystem": "simple",
          "build-commands": [
            "pip3 install --prefix=/app numpy-1.13.1-cp35-cp35m-manylinux1_x86_64.whl"
          ],
          "sources": [{
            "type": "file",
            "url": "https://pypi.python.org/packages/1a/45/40d946e712d4f2a767db001f58020e33b7d1dc77c09fab03a5883336792d/numpy-1.13.1-cp35-cp35m-manylinux1_x86_64.whl",
            "sha256": "9a8515002f143a5934f25ad2aacdfd1fcf57a7f5da6142c439eb8787ef65e8a6"
          }]
        },
        {
          "name": "pillow-simd",
          "buildsystem": "simple",
          "build-commands": [
            "python3 setup.py install --prefix=/app --root=/ --optimize=1"
          ],
          "sources": [{
            "type": "archive",
            "url": "https://pypi.python.org/packages/b0/d7/c671de32baf7a5e8a9a505096b004b285b83963a49dd0bd0b1c3c16b7b3d/Pillow-SIMD-4.1.1.post0.tar.gz",
            "sha256": "09e5c8e4835db7cc90a0b9ad305a2d280a69f4e5fb3371dcc4abde86b41ecc0b"
          }],
          "modules": [{
            "name": "olefile",
            "buildsystem": "simple",
            "build-commands": [
              "python3 setup.py install --prefix=/app --root=/ --optimize=1"
            ],
            "sources": [{
              "type": "archive",
              "url": "https://pypi.python.org/packages/35/17/c15d41d5a8f8b98cc3df25eb00c5cee76193114c78e5674df6ef4ac92647/olefile-0.44.zip",
              "sha256": "61f2ca0cd0aa77279eb943c07f607438edf374096b66332fae1ee64a6f0f73ad"
            }]
          }]
        }
      ]
    }
  ]
}
